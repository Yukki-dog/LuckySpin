<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ö–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω—ã</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
    }
    input[type="number"] {
      width: 80px;
      padding: 5px;
    }
    canvas {
      margin-top: 20px;
      border: 2px solid #333;
      border-radius: 50%;
    }
  </style>
</head>
<body>

  <h1>üé° –ö–æ–ª–µ—Å–æ —Ñ–æ—Ä—Ç—É–Ω—ã</h1>

  <label>–°–∫–æ–ª—å–∫–æ —è—á–µ–µ–∫? 
    <input type="number" id="cellCount" min="1" placeholder="–ù–∞–ø—Ä. 4">
  </label>

  <br><br>

  <label>–ó–∞–≥—Ä—É–∑–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: 
    <input type="file" id="imageInput" accept="image/*" multiple>
  </label>

  <br><br>

  <button onclick="generateWheel()">–°–æ–∑–¥–∞—Ç—å –∫–æ–ª–µ—Å–æ</button>

  <canvas id="wheelCanvas" width="400" height="400"></canvas>

  <script>
    function generateWheel() {
      const cellCountInput = document.getElementById('cellCount');
      const fileInput = document.getElementById('imageInput');
      const cellCount = parseInt(cellCountInput.value);
      const files = Array.from(fileInput.files);

      if (isNaN(cellCount) || cellCount < 1) {
        alert("–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —á–∏—Å–ª–æ —è—á–µ–µ–∫ (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –±–æ–ª—å—à–µ 0).");
        return;
      }

      if (files.length !== cellCount) {
        alert(`–í—ã –∑–∞–≥—Ä—É–∑–∏–ª–∏ ${files.length} –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∞ —É–∫–∞–∑–∞–ª–∏ ${cellCount} —è—á–µ–µ–∫!`);
        return;
      }

      const canvas = document.getElementById('wheelCanvas');
      const ctx = canvas.getContext('2d');
      const radius = canvas.width / 2;
      const centerX = radius;
      const centerY = radius;
      const angleStep = (2 * Math.PI) / cellCount;

      ctx.clearRect(0, 0, canvas.width, canvas.height);

      files.forEach((file, i) => {
        const angle = i * angleStep;
        const img = new Image();
        img.onload = () => {
          ctx.save();
          ctx.translate(centerX, centerY);
          ctx.rotate(angle + angleStep / 2);
          ctx.drawImage(img, radius / 4, -40, 80, 80);
          ctx.restore();

          // –°–µ–∫—Ç–æ—Ä
          ctx.beginPath();
          ctx.moveTo(centerX, centerY);
          ctx.arc(centerX, centerY, radius, angle, angle + angleStep);
          ctx.closePath();
          ctx.stroke();
        };
        img.src = URL.createObjectURL(file);
      });
    }

    // –¢–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã
    document.getElementById('cellCount').addEventListener('keypress', function (e) {
      if (!/[0-9]/.test(e.key)) {
        e.preventDefault();
      }
    });
  </script>

</body>
</html>
